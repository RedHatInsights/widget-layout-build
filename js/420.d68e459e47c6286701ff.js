"use strict";(self.webpackChunkwidget_layout=self.webpackChunkwidget_layout||[]).push([[420],{74312:(e,t,n)=>{n.r(t),n.d(t,{breakpoints:()=>te,default:()=>oe,dropping_elem_id:()=>ee});var r=n(96803);const o=n.p+"fonts/resize-handle.svg";var a,i=n(41556),c=n(6172),u=n(56020),l=n(95780),s=n(82528),f=n(24144),d=n(27924),p=n(11136),m=n(23132),h=n.n(m),g=n(74640),v=n(68768),y=n(79596),b=n(46784),w=n(96740);const E=((a={})[y.E.LargeWidget]=v.c,a[y.E.MediumWidget]=b.c,a[y.E.SmallWidget]=w.c,a);var x=n(51320);const k=function(e){var t=e.widgetType,n=e.title,r=e.isDragging,o=e.setIsDragging,a=e.setWidgetAttribute,v=e.widgetConfig,y=e.removeWidget,b=(0,m.useState)(!1),w=b[0],k=b[1],T=E[t]||m.Fragment,W=(0,m.useMemo)((function(){var e=v.h===v.maxH,t=v.h===v.minH;return h().createElement(h().Fragment,null,h().createElement(i.DropdownItem,{onClick:function(){k(!1),a(v.i,"static",!v.static)},icon:v.static?h().createElement(c.mc,null):h().createElement(u.mp,null)},v.static?"Unlock location and size":"Lock location and size"),h().createElement(i.DropdownItem,{isDisabled:e||v.static,onClick:function(){var e;a(v.i,"h",null!==(e=v.maxH)&&void 0!==e?e:v.h),k(!1)},icon:h().createElement(l.c9,null)},"Autosize height to content"),h().createElement(i.DropdownItem,{onClick:function(){var e;a(v.i,"h",null!==(e=v.minH)&&void 0!==e?e:v.h),k(!1)},isDisabled:t||v.static,icon:h().createElement(s.GQ,null)},"Minimize height"),h().createElement(i.DropdownItem,{onClick:function(){y(v.i)},icon:h().createElement(i.Icon,{className:"pf-v5-u-pb-2xl",status:v.static?void 0:"danger"},h().createElement(f.QR,null)),isDisabled:v.static},"Remove",h().createElement(i.HelperText,null,h().createElement(i.HelperTextItem,{className:"pf-v5-u-text-wrap",variant:"indeterminate"},"All 'removed' widgets can be added back by clicking the 'Add widgets' button."))))}),[v.minH,v.maxH,v.h,v.i,v.static,a]),S=h().createElement(h().Fragment,null,h().createElement(i.Tooltip,{content:h().createElement("p",null,"Actions")},h().createElement(i.Dropdown,{popperProps:{appendTo:document.body,maxWidth:"300px",position:"right"},toggle:function(e){return h().createElement(i.MenuToggle,{ref:e,isExpanded:w,onClick:function(){return k((function(e){return!e}))},variant:"plain","aria-label":"Card title inline with images and actions example kebab toggle"},h().createElement(d._Y,{"aria-hidden":"true"}))},isOpen:w,onOpenChange:function(e){return k(e)}},h().createElement(i.DropdownList,null,W))),h().createElement(i.Tooltip,{content:h().createElement("p",null,v.static?"Widget locked":"Move")},h().createElement(i.Icon,{onMouseDown:function(){return o(!0)},onMouseUp:function(){return o(!1)},className:(0,g.c)("drag-handle",{dragging:r})},h().createElement(p.Sw,{style:{fill:"#6a6e73"}}))));return h().createElement(i.Card,{className:(0,g.c)("grid-tile",{static:v.static})},h().createElement(i.CardHeader,{actions:{actions:S}},h().createElement(i.Flex,{className:"pf-v5-u-flex-direction-row pf-v5-u-flex-nowrap"},h().createElement(i.Icon,{status:"custom",className:"pf-v5-u-mr-sm"},h().createElement(x.u7,null)),h().createElement(i.CardTitle,{style:{userSelect:r?"none":"auto"},className:"pf-v5-u-flex-wrap pf-v5-u-text-break-word"},n))),h().createElement(i.Divider,null),h().createElement(i.CardBody,{className:"pf-v5-u-p-0"},h().createElement(T,null)))};var T,W,S,C,O,D=((T={})[y.E.LargeWidget]=4,T[y.E.MediumWidget]=2,T[y.E.SmallWidget]=1,T),A=((W={})[y.E.LargeWidget]=3,W[y.E.MediumWidget]=2,W[y.E.SmallWidget]=1,W),j=((S={})[y.E.LargeWidget]=6,S[y.E.MediumWidget]=4,S[y.E.SmallWidget]=2,S),H=((C={})[y.E.LargeWidget]=1,C[y.E.MediumWidget]=1,C[y.E.SmallWidget]=1,C),P=n(26008),M=n(62644),_=n(9920),I=(0,P.atom)({sm:[],md:[],lg:[],xl:[]}),L=(0,P.atom)(-1),N=(O=function(e,t){return O=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},O(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}O(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),z=function(){return z=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},z.apply(this,arguments)},F=function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{u(r.next(e))}catch(e){a(e)}}function c(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,c)}u((r=r.apply(e,t||[])).next())}))},R=function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(c){return function(u){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,u])}}},U=function(e){return{Accept:"application/json",Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}},G=function(e){function t(t,n,r){var o=this.constructor,a=e.call(this,t)||this;return a.status=n,a.response=r,Object.defineProperty(a,"name",{value:o.name,configurable:!0}),"function"==typeof Error.captureStackTrace?Error.captureStackTrace(a,a.constructor):a.stack=new Error(t).stack,a}return N(t,e),t}(Error),q=function(e){if(!e.ok)throw new G("chrome-service dashboard-templates API fetch error",e.status,e)},Y=function(e){var t=e.split("#");return[t[0],t[1]]},B=function(e){return z(z({},e),{widgetType:Y(e.i)[0]})},Q=function(e){var t={sm:[],md:[],lg:[],xl:[]};return Object.keys(e).forEach((function(n){t[n]=e[n].map(B)})),t},J=function(e){return{x:e.x,y:e.y,h:e.h,i:e.i,w:e.w,title:e.title,maxH:e.maxH,minH:e.minH,static:e.static}},K=n(99700),V=n(19152),X=n(14488),Z=n(33568),$=function(){return $=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},$.apply(this,arguments)},ee="__dropping-elem__",te={xl:1100,lg:996,md:768,sm:480},ne=(0,r.WidthProvider)(r.Responsive),re=function(e,t){return h().createElement("div",{ref:t,className:"react-resizable-handle react-resizable-handle-".concat(e)},h().createElement("img",{src:o}))};const oe=function(e){var t=e.isLayoutLocked,n=void 0!==t&&t,r=(0,m.useState)(!1),o=r[0],a=r[1],i=(0,m.useState)(!0),c=i[0],u=i[1],l=(0,P.useAtom)(_.qA),s=l[0],f=l[1],d=(0,P.useAtom)(_.Ij),p=d[0],g=d[1],v=(0,P.useAtom)(_.gT),b=v[0],w=v[1],E=(0,P.useAtom)(I),x=E[0],T=E[1],W=(0,P.useAtom)(L),S=W[0],C=W[1],O=(0,P.useAtom)(_.i2),N=O[0],z=O[1],G=(0,m.useRef)(null),Y=(0,K.c)().currentToken,B=(0,V.useDispatch)(),oe=(0,P.useAtom)(M.Y),ae=oe[0],ie=oe[1],ce=(0,m.useMemo)((function(){if(ae)return{i:ee,w:D[ae],h:A[ae],widgetType:ae,title:"New title"}}),[ae]),ue=function(e,t,n){f((function(r){return r.map((function(r){var o;return r.i===e?$($({},r),((o={})[t]=n,o)):r}))}))},le=function(e){f((function(t){return t.filter((function(t){return t.i!==e}))}))},se=(0,m.useMemo)((function(){return s.map((function(e){return $($({},e),{locked:n||e.locked})}))}),[n,s]),fe=(0,m.useCallback)((function(e){var t;if(c)u(!1);else if(!(n||S<0||!b||ae||(0,Z.isEqual)(p,s))){var r,o,a=((t={})[b]=e,r=t,o={},Object.keys(r).forEach((function(e){var t;o[e]=null===(t=r[e])||void 0===t?void 0:t.map(J).filter((function(e){return e.i!==ee}))})),o);(function(e,t,n){return F(void 0,void 0,Promise,(function(){var r;return R(this,(function(o){switch(o.label){case 0:return[4,fetch("/api/chrome-service/v1/dashboard-templates/".concat(e),{method:"PATCH",headers:U(n),body:JSON.stringify(t)})];case 1:return r=o.sent(),q(r),[4,r.json()];case 2:return[2,o.sent().data]}}))}))})(S,{templateConfig:a},Y).then((function(e){var t=Q(e.templateConfig);T(t),g(s),f(t[b])})).catch((function(e){console.error(e),B((0,X.s5)({variant:"danger",title:"Failed to patch dashboard configuration",description:"Your dashboard changes were unable to be saved."}))}))}}),[n,S,b,Y,s,ae,c]),de=(0,Z.debounce)(fe,500),pe=(0,m.useCallback)((function(e){if(N){var t=s.find((function(e){return e.i===N}));t&&(e.stopPropagation(),e.preventDefault(),"ArrowUp"===e.code&&f((function(e){return e.map((function(e){return e.i===N?$($({},e),{y:Math.max(e.y-1,0)}):e}))})),"ArrowDown"===e.code&&f((function(e){return e.map((function(e){return e.i===N?$($({},e),{y:e.y+1}):e}))})),"ArrowLeft"===e.code&&f((function(e){return e.map((function(e){return e.i===N?$($({},e),{x:Math.max(e.x-1,0)}):e}))})),"ArrowRight"===e.code&&f((function(e){return e.map((function(e){return e.i===N?$($({},e),{x:e.x+1}):e}))})))}}),[N]);return(0,m.useEffect)((function(){return N&&G.current&&G.current.addEventListener("keydown",pe),function(){var e;null===(e=G.current)||void 0===e||e.removeEventListener("keydown",pe)}}),[N]),(0,m.useEffect)((function(){!Y||S>=0||function(e,t){return F(this,void 0,Promise,(function(){var n;return R(this,(function(r){switch(r.label){case 0:return[4,fetch("/api/chrome-service/v1/dashboard-templates".concat(t?"?dashboard=".concat(t):""),{method:"GET",headers:U(e)})];case 1:return n=r.sent(),q(n),[4,n.json()];case 2:return[2,r.sent().data]}}))}))}(Y,"landingPage").then((function(e){var t,n=function(e){return e.find((function(e){return!0===e.default}))}(e);if(!n)throw new Error("No default template found");var r,o=Q(n.templateConfig),a=(null===(t=null==G?void 0:G.current)||void 0===t?void 0:t.clientWidth)||document.body.clientWidth;r=a>te.lg?"xl":te.lg>=a&&a>te.md?"lg":te.md>=a&&a>te.sm?"md":"sm",T(o),C(n.id),f(o[r]),w(r)})).catch((function(e){console.log(e),B((0,X.s5)({variant:"danger",title:"Failed to fetch dashboard template",description:"Try reloading the page."}))}))}),[Y,S]),h().createElement("div",{style:{position:"relative"},ref:G},h().createElement(ne,{className:"layout",draggableHandle:".drag-handle",layouts:x,breakpoints:te,cols:{xl:4,lg:3,md:2,sm:1},rowHeight:88,isDraggable:!n,isResizable:!n,resizeHandle:re,containerPadding:{xl:[0,0],lg:[0,0],md:[0,0],sm:[0,0]},margin:{xl:[16,16],lg:[16,16],md:[16,16],sm:[16,16]},resizeHandles:["sw","nw","se","ne"],droppingItem:ce,isDroppable:!n,onDrop:function(e,t,n){var r,o=(null===(r=n.dataTransfer)||void 0===r?void 0:r.getData("text"))||"";if((0,y.u)(o)){var a=$($({},t),{h:A[o],maxH:j[o],minH:H[o],widgetType:o,i:"".concat(o,"#").concat(Date.now()+Math.random()),title:"New title"});ie(void 0),f((function(e){return e.reduce((function(e,t){return t.x+t.w>a.x&&t.y+t.h<=a.y?e.push(t):e.push($($({},t),{y:t.y+t.h})),e}),[a])}))}n.preventDefault()},useCSSTransforms:!0,verticalCompact:!0,onLayoutChange:de,onBreakpointChange:function(e){w(e)}},se.map((function(e,t){var n=e.widgetType,r=(e.title,function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n}(e,["widgetType","title"]));return h().createElement("div",{key:r.i,"data-grid":r,onKeyUp:function(e){return t=e,n=r.i,void("Enter"===t.code&&(t.preventDefault(),t.stopPropagation(),z((function(e){if(e!==n)return n}))));var t,n},tabIndex:t,style:$({boxShadow:N===r.i?"0 0 2px 2px #2684FF":"none"},N===r.i?{outline:"none"}:{})},h().createElement(k,{isDragging:o,setIsDragging:a,title:r.i,widgetType:n,widgetConfig:$($({},r),{colWidth:300}),setWidgetAttribute:ue,removeWidget:le},r.i))}))))}},68768:(e,t,n)=>{n.d(t,{c:()=>a});var r=n(23132),o=n.n(r);const a=function(e){var t=e.children;return o().createElement(o().Fragment,null,t)}},46784:(e,t,n)=>{n.d(t,{c:()=>a});var r=n(23132),o=n.n(r);const a=function(e){var t=e.children;return o().createElement(o().Fragment,null,t)}},96740:(e,t,n)=>{n.d(t,{c:()=>a});var r=n(23132),o=n.n(r);const a=function(e){var t=e.children;return o().createElement(o().Fragment,null,t)}},79596:(e,t,n)=>{var r;function o(e){return Object.values(r).includes(e)}n.d(t,{E:()=>r,u:()=>o}),function(e){e.LargeWidget="LargeWidget",e.MediumWidget="MediumWidget",e.SmallWidget="SmallWidget"}(r||(r={}))},99700:(e,t,n)=>{n.d(t,{c:()=>i});var r=n(23132);const o=function(e){var t=(0,r.useState)(!1),n=t[0],o=t[1];return(0,r.useEffect)((function(){var t,n,r,a;t=void 0,n=void 0,a=function(){return function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(c){return function(u){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,u])}}}(this,(function(t){switch(t.label){case 0:return[4,e()];case 1:return t.sent(),o(!0),[2]}}))},new((r=void 0)||(r=Promise))((function(e,o){function i(e){try{u(a.next(e))}catch(e){o(e)}}function c(e){try{u(a.throw(e))}catch(e){o(e)}}function u(t){var n;t.done?e(t.value):(n=t.value,n instanceof r?n:new r((function(e){e(n)}))).then(i,c)}u((a=a.apply(t,n||[])).next())}))}),[]),n};var a=n(73804);const i=function(){var e=(0,r.useState)(void 0),t=e[0],n=e[1],i=(0,r.useState)(""),c=i[0],u=i[1],l=(0,a.c)(),s=o((function(){return e=void 0,t=void 0,o=function(){var e,t;return function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(c){return function(u){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,u])}}}(this,(function(r){switch(r.label){case 0:return[4,l.auth.getUser()];case 1:return(e=r.sent())&&n(e.identity.user),[4,l.auth.getToken()];case 2:return(t=r.sent())&&u(t),[2]}}))},new((r=void 0)||(r=Promise))((function(n,a){function i(e){try{u(o.next(e))}catch(e){a(e)}}function c(e){try{u(o.throw(e))}catch(e){a(e)}}function u(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(i,c)}u((o=o.apply(e,t||[])).next())}));var e,t,r,o}));return{isLoaded:s,currentUser:t,currentToken:c}}},62644:(e,t,n)=>{n.d(t,{Y:()=>r});var r=(0,n(26008).atom)(void 0)},9920:(e,t,n)=>{n.d(t,{Ij:()=>l,Q9:()=>a,gT:()=>c,i2:()=>s,kH:()=>i,qA:()=>u});var r=n(33568),o=n(26008),a=[];function i(e){return(0,r.isEqual)(a,e)}var c=(0,o.atom)("xl"),u=(0,o.atom)(a),l=(0,o.atom)(a),s=(0,o.atom)(void 0)}}]);
//# sourceMappingURL=../sourcemaps/420.33c6d42510ae4911374a2c75c54ba92e.js.map